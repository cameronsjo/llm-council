{"id":"council-081","title":"audit: attachments.py validate_file + save_attachment + get_attachment_path","status":"closed","priority":3,"issue_type":"task","owner":"cameronsjo@users.noreply.github.com","created_at":"2026-02-05T20:00:56.99202-06:00","created_by":"Cameron Sjo","updated_at":"2026-02-05T20:34:21.594896-06:00","closed_at":"2026-02-05T20:34:21.594896-06:00","close_reason":"Code fixes applied, tests written, untestable code documented","labels":["just-do-it"],"comments":[{"id":60,"issue_id":"council-081","author":"Cameron Sjo","text":"Grade: M:B T:C - File I/O operations. validate_file is pure and testable. save_attachment uses content-hash naming (good). get_attachment_path hits filesystem.","created_at":"2026-02-06T02:01:00Z"}]}
{"id":"council-114","title":"audit: export.py export_to_markdown","status":"closed","priority":3,"issue_type":"task","owner":"cameronsjo@users.noreply.github.com","created_at":"2026-02-05T20:00:45.713265-06:00","created_by":"Cameron Sjo","updated_at":"2026-02-05T20:34:21.62847-06:00","closed_at":"2026-02-05T20:34:21.62847-06:00","close_reason":"Code fixes applied, tests written, untestable code documented","labels":["just-do-it"],"comments":[{"id":58,"issue_id":"council-114","author":"Cameron Sjo","text":"Grade: M:C T:B - Long string-building function (~130 lines). Handles both council and arena formats. Could be split into smaller functions. No HTML escaping.","created_at":"2026-02-06T02:00:48Z"}]}
{"id":"council-1g6","title":"run_full_council","description":"council.py:670-734 — Complete 3-stage council orchestrator. Only used by non-streaming endpoint. Parallel code path that must be maintained alongside streaming path.","status":"closed","priority":2,"issue_type":"task","owner":"cameronsjo@users.noreply.github.com","created_at":"2026-02-05T19:50:59.064394-06:00","created_by":"Cameron Sjo","updated_at":"2026-02-06T12:24:26.53227-06:00","closed_at":"2026-02-06T12:24:26.53227-06:00","close_reason":"Removed dead non-streaming code path. PR #12.","labels":["audit","plan-worthy"],"comments":[{"id":15,"issue_id":"council-1g6","author":"Cameron Sjo","text":"GRADE: M=B, T=B | Only used by non-streaming endpoint. Parallel code path that must be maintained alongside streaming. RECOMMENDATION: Remove or make streaming path delegate to this.","created_at":"2026-02-06T01:52:36Z"}]}
{"id":"council-1gv","title":"Stage 3 chairman retry: allow re-running Stage 3 without repeating Stage 1+2","description":"When chairman model fails after Stage 1+2 complete, user loses all money spent. The error 'Unable to generate final synthesis' is returned but Stage 1+2 results exist. Need: (1) persist Stage 2 results to pending partial_data, (2) add resume path that skips to Stage 3 only, (3) offer retry-Stage-3 button in frontend when Stage 3 fails but earlier stages succeeded. Currently only Stage 1→2 resume exists.","status":"closed","priority":0,"issue_type":"bug","owner":"cameronsjo@users.noreply.github.com","created_at":"2026-02-06T14:29:14.863514-06:00","created_by":"Cameron Sjo","updated_at":"2026-02-06T14:41:20.492885-06:00","closed_at":"2026-02-06T14:41:20.492885-06:00","close_reason":"Stage 3 retry fully implemented — backend pipeline + storage + SSE endpoint + frontend UI + 20 tests. PR #18","labels":["plan-worthy"]}
{"id":"council-1ng","title":"Audit: Synthesis component (rendering, copy, continue discussion)","status":"closed","priority":2,"issue_type":"task","owner":"cameronsjo@users.noreply.github.com","created_at":"2026-02-05T20:00:26.855416-06:00","created_by":"Cameron Sjo","updated_at":"2026-02-05T20:34:19.668465-06:00","closed_at":"2026-02-05T20:34:19.668465-06:00","close_reason":"Code fixes applied, tests written, untestable code documented","labels":["just-do-it"],"comments":[{"id":49,"issue_id":"council-1ng","author":"Cameron Sjo","text":"Grade: M:B T:C - Manageable size. Inline handleCopy and handleContinueDiscussion handlers. formatCost and getReasoningText are DUPLICATED from Round.jsx - maintainability issue.","created_at":"2026-02-06T02:00:29Z"}]}
{"id":"council-1xm","title":"audit: logging_config.py context var accessors","status":"closed","priority":4,"issue_type":"task","owner":"cameronsjo@users.noreply.github.com","created_at":"2026-02-05T20:01:22.771245-06:00","created_by":"Cameron Sjo","updated_at":"2026-02-05T20:34:25.824946-06:00","closed_at":"2026-02-05T20:34:25.824946-06:00","close_reason":"Code fixes applied, tests written, untestable code documented","labels":["just-do-it"],"comments":[{"id":64,"issue_id":"council-1xm","author":"Cameron Sjo","text":"Grade: M:A T:A - Trivial ContextVar wrappers. Clean and testable.","created_at":"2026-02-06T02:01:25Z"}]}
{"id":"council-2ji","title":"Audit: MetricsDisplay component (cost/token/latency display)","status":"closed","priority":3,"issue_type":"task","owner":"cameronsjo@users.noreply.github.com","created_at":"2026-02-05T20:00:32.71646-06:00","created_by":"Cameron Sjo","updated_at":"2026-02-05T20:34:21.728148-06:00","closed_at":"2026-02-05T20:34:21.728148-06:00","close_reason":"Code fixes applied, tests written, untestable code documented","labels":["just-do-it"],"comments":[{"id":53,"issue_id":"council-2ji","author":"Cameron Sjo","text":"Grade: M:B T:C - Well-structured with expandable sections. Utility functions (formatCost, formatLatency, formatTokens) are clean and testable.","created_at":"2026-02-06T02:00:35Z"}]}
{"id":"council-2nl","title":"convert_legacy_message_to_unified","description":"council.py:822-875 — Converts old stored messages to unified format. Handles backward compatibility. Re-calculates aggregate rankings from stored data.","status":"closed","priority":3,"issue_type":"task","owner":"cameronsjo@users.noreply.github.com","created_at":"2026-02-05T19:51:02.182803-06:00","created_by":"Cameron Sjo","updated_at":"2026-02-05T20:34:25.642072-06:00","closed_at":"2026-02-05T20:34:25.642072-06:00","close_reason":"Code fixes applied, tests written, untestable code documented","labels":["audit","just-do-it"],"comments":[{"id":17,"issue_id":"council-2nl","author":"Cameron Sjo","text":"GRADE: M=B, T=B | Handles backward compatibility. Re-calculates aggregate rankings from stored data. Copies extra fields in a loop. RECOMMENDATION: Add tests for edge cases.","created_at":"2026-02-06T01:52:38Z"}]}
{"id":"council-2yf","title":"Deep dive on websearch API functionality - likely broken","description":"Investigate the web search (Tavily) integration. Suspected to be non-functional or incorrect. Need to trace the full flow: frontend toggle → backend search → context injection → model queries. Check: Tavily API calls, error handling, result formatting, and whether search context actually reaches the models.","status":"closed","priority":2,"issue_type":"bug","owner":"cameronsjo@users.noreply.github.com","created_at":"2026-02-06T08:57:28.180056-06:00","created_by":"Cameron Sjo","updated_at":"2026-02-06T12:43:49.723743-06:00","closed_at":"2026-02-06T12:43:49.723743-06:00","close_reason":"Web search feature is FULLY FUNCTIONAL, not broken. Complete trace from frontend toggle through backend search to model context confirms all connections work. DuckDuckGo provides free fallback. Only gap: no integration tests (pure function tests exist)."}
{"id":"council-301","title":"audit: auth.py _parse_trusted_ips","status":"closed","priority":3,"issue_type":"task","owner":"cameronsjo@users.noreply.github.com","created_at":"2026-02-05T20:00:25.387624-06:00","created_by":"Cameron Sjo","updated_at":"2026-02-05T20:34:21.787188-06:00","closed_at":"2026-02-05T20:34:21.787188-06:00","close_reason":"Code fixes applied, tests written, untestable code documented","labels":["just-do-it"],"comments":[{"id":48,"issue_id":"council-301","author":"Cameron Sjo","text":"Grade: M:B T:A - Clean parsing with error handling. Pure function given module-level constant.","created_at":"2026-02-06T02:00:28Z"}]}
{"id":"council-35i","title":"stage3_synthesize_final","description":"council.py:329-425 — Chairman synthesizes final response. CRITICAL: Reveals model names to chairman breaking anonymization. No retry logic for most important API call.","status":"closed","priority":1,"issue_type":"task","owner":"cameronsjo@users.noreply.github.com","created_at":"2026-02-05T19:50:49.028135-06:00","created_by":"Cameron Sjo","updated_at":"2026-02-06T12:12:36.699359-06:00","closed_at":"2026-02-06T12:12:36.699359-06:00","close_reason":"PR #9: anonymized chairman prompt, added retry","labels":["audit","plan-worthy"],"comments":[{"id":7,"issue_id":"council-35i","author":"Cameron Sjo","text":"GRADE: M=C, T=C | BREAKS ANONYMIZATION: Chairman sees 'Model: openai/gpt-5.1' in prompt (line 361). Stage 2 carefully anonymizes but Stage 3 reveals everything. No retry for most important API call. Huge prompt literal. RECOMMENDATION: Use anonymous labels in chairman prompt. Add retry with fallback.","created_at":"2026-02-06T01:52:16Z"}]}
{"id":"council-3n7","title":"Audit: deAnonymizeText (Round.jsx)","status":"closed","priority":2,"issue_type":"task","owner":"cameronsjo@users.noreply.github.com","created_at":"2026-02-05T20:00:22.042578-06:00","created_by":"Cameron Sjo","updated_at":"2026-02-05T20:34:19.669759-06:00","closed_at":"2026-02-05T20:34:19.669759-06:00","close_reason":"Code fixes applied, tests written, untestable code documented","labels":["just-do-it"],"comments":[{"id":45,"issue_id":"council-3n7","author":"Cameron Sjo","text":"Grade: M:B T:A - Pure function, regex-based replacement of anonymous labels with model names. Simple and well-focused.","created_at":"2026-02-06T02:00:24Z"}]}
{"id":"council-4ba","title":"perform_web_search","description":"council.py:647-667 — Simple delegation wrapper for web search. Returns tuple (result, error). Clean design.","status":"closed","priority":4,"issue_type":"task","owner":"cameronsjo@users.noreply.github.com","created_at":"2026-02-05T19:51:43.052102-06:00","created_by":"Cameron Sjo","updated_at":"2026-02-05T20:34:27.375539-06:00","closed_at":"2026-02-05T20:34:27.375539-06:00","close_reason":"Code fixes applied, tests written, untestable code documented","labels":["audit","just-do-it"],"comments":[{"id":29,"issue_id":"council-4ba","author":"Cameron Sjo","text":"GRADE: M=A, T=A | Simple delegation wrapper. Clean tuple return. No issues.","created_at":"2026-02-06T01:53:04Z"}]}
{"id":"council-4jh","title":"Audit: VersionInfo component (version display modal)","status":"closed","priority":4,"issue_type":"task","owner":"cameronsjo@users.noreply.github.com","created_at":"2026-02-05T20:00:19.455849-06:00","created_by":"Cameron Sjo","updated_at":"2026-02-05T20:34:27.31407-06:00","closed_at":"2026-02-05T20:34:27.31407-06:00","close_reason":"Code fixes applied, tests written, untestable code documented","labels":["just-do-it"],"comments":[{"id":43,"issue_id":"council-4jh","author":"Cameron Sjo","text":"Grade: M:B T:B - Simple component, lazy-loads version data from API. Clean separation.","created_at":"2026-02-06T02:00:21Z"}]}
{"id":"council-4ty","title":"Audit: useModelFiltering hook (filter pipeline, clearFilters)","status":"closed","priority":3,"issue_type":"task","owner":"cameronsjo@users.noreply.github.com","created_at":"2026-02-05T20:00:19.168625-06:00","created_by":"Cameron Sjo","updated_at":"2026-02-05T20:34:23.517326-06:00","closed_at":"2026-02-05T20:34:23.517326-06:00","close_reason":"Code fixes applied, tests written, untestable code documented","labels":["just-do-it"],"comments":[{"id":44,"issue_id":"council-4ty","author":"Cameron Sjo","text":"Grade: M:B T:B - Solid useMemo-based filtering pipeline. Multiple filter dimensions compose cleanly. Dependency array is correct and complete.","created_at":"2026-02-06T02:00:22Z"}]}
{"id":"council-4vt","title":"Purify: extract _build_partial_assistant_message from App.jsx handleSendMessage","status":"closed","priority":3,"issue_type":"task","owner":"cameronsjo@users.noreply.github.com","created_at":"2026-02-05T20:35:50.765804-06:00","created_by":"Cameron Sjo","updated_at":"2026-02-06T12:34:01.169856-06:00","closed_at":"2026-02-06T12:34:01.169856-06:00","close_reason":"Already resolved by useConversationStream refactor. buildAssistantMessage extracted to conversationReducer.js, _build_partial_message_from_pending no longer exists.","labels":["plan-worthy"]}
{"id":"council-59k","title":"Audit: getParticipantMapping helper (ChatInterface.jsx)","status":"closed","priority":3,"issue_type":"task","owner":"cameronsjo@users.noreply.github.com","created_at":"2026-02-05T20:00:05.881332-06:00","created_by":"Cameron Sjo","updated_at":"2026-02-05T20:34:23.664727-06:00","closed_at":"2026-02-05T20:34:23.664727-06:00","close_reason":"Code fixes applied, tests written, untestable code documented","labels":["just-do-it"],"comments":[{"id":36,"issue_id":"council-59k","author":"Cameron Sjo","text":"Grade: M:B T:B - Simple extraction, handles both unified and legacy formats.","created_at":"2026-02-06T02:00:08Z"}]}
{"id":"council-67r","title":"audit: export.py export_to_json + format_model_name","status":"closed","priority":4,"issue_type":"task","owner":"cameronsjo@users.noreply.github.com","created_at":"2026-02-05T20:00:51.425072-06:00","created_by":"Cameron Sjo","updated_at":"2026-02-05T20:34:27.151985-06:00","closed_at":"2026-02-05T20:34:27.151985-06:00","close_reason":"Code fixes applied, tests written, untestable code documented","labels":["just-do-it"],"comments":[{"id":59,"issue_id":"council-67r","author":"Cameron Sjo","text":"Grade: M:A T:A - Trivially simple. export_to_json is essentially a dict filter. format_model_name is a one-liner.","created_at":"2026-02-06T02:00:54Z"}]}
{"id":"council-6an","title":"convert_to_unified_result","description":"council.py:737-819 — Converts legacy stage-based results to unified DeliberationResult. Pure data transformation. Clean and testable.","status":"closed","priority":3,"issue_type":"task","owner":"cameronsjo@users.noreply.github.com","created_at":"2026-02-05T19:51:02.028006-06:00","created_by":"Cameron Sjo","updated_at":"2026-02-05T20:34:25.682303-06:00","closed_at":"2026-02-05T20:34:25.682303-06:00","close_reason":"Code fixes applied, tests written, untestable code documented","labels":["audit","just-do-it"],"comments":[{"id":16,"issue_id":"council-6an","author":"Cameron Sjo","text":"GRADE: M=A-, T=A | Pure data transformation. Correctly maps stages to rounds. Clean bridge function. No issues.","created_at":"2026-02-06T01:52:37Z"}]}
{"id":"council-6x1","title":"get_conversation (storage)","description":"storage.py:129-156 — Reads JSON from disk on every call. No caching. migrate_legacy_messages called on every read by default. No file locking.","status":"closed","priority":2,"issue_type":"task","owner":"cameronsjo@users.noreply.github.com","created_at":"2026-02-05T19:51:24.419334-06:00","created_by":"Cameron Sjo","updated_at":"2026-02-05T20:34:19.675141-06:00","closed_at":"2026-02-05T20:34:19.675141-06:00","close_reason":"Code fixes applied, tests written, untestable code documented","labels":["audit","just-do-it"],"comments":[{"id":20,"issue_id":"council-6x1","author":"Cameron Sjo","text":"GRADE: M=C, T=B | Reads JSON from disk every call. No caching. migrate_legacy_messages on every read. No file locking for concurrent access. RECOMMENDATION: In-memory cache with invalidation, file locking.","created_at":"2026-02-06T01:52:46Z"}]}
{"id":"council-75a","title":"Audit: ChatInterface component (handleSubmit, handleKeyDown, rendering, streaming)","status":"closed","priority":1,"issue_type":"task","owner":"cameronsjo@users.noreply.github.com","created_at":"2026-02-05T19:59:50.237674-06:00","created_by":"Cameron Sjo","updated_at":"2026-02-06T12:21:12.878325-06:00","closed_at":"2026-02-06T12:21:12.878325-06:00","close_reason":"Extracted 5 pure functions to lib/messageUtils.js with 24 tests. PR #11.","labels":["plan-worthy"],"comments":[{"id":31,"issue_id":"council-75a","author":"Cameron Sjo","text":"Grade: M:D T:F - 300+ line component with inline event handlers, streaming state management, mode switching. handleSubmit is deeply nested, cannot be unit tested. Mixes data transformation with rendering.","created_at":"2026-02-06T01:59:52Z"}]}
{"id":"council-7ec","title":"Audit: SkeletonLoader components (SkeletonTabs, SkeletonContent, SkeletonStage, SkeletonSynthesis)","status":"closed","priority":4,"issue_type":"task","owner":"cameronsjo@users.noreply.github.com","created_at":"2026-02-05T20:00:13.794741-06:00","created_by":"Cameron Sjo","updated_at":"2026-02-05T20:34:27.345026-06:00","closed_at":"2026-02-05T20:34:27.345026-06:00","close_reason":"Code fixes applied, tests written, untestable code documented","labels":["just-do-it"],"comments":[{"id":41,"issue_id":"council-7ec","author":"Cameron Sjo","text":"Grade: M:A T:A - Pure presentational components with no logic. CSS animation only. Trivially testable.","created_at":"2026-02-06T02:00:16Z"}]}
{"id":"council-7yo","title":"Audit: ModelCuration component (modal, toggleCurated, addAll, removeAll, getBulkAction)","status":"closed","priority":3,"issue_type":"task","owner":"cameronsjo@users.noreply.github.com","created_at":"2026-02-05T20:00:03.734172-06:00","created_by":"Cameron Sjo","updated_at":"2026-02-05T20:34:23.696973-06:00","closed_at":"2026-02-05T20:34:23.696973-06:00","close_reason":"Code fixes applied, tests written, untestable code documented","labels":["just-do-it"],"comments":[{"id":35,"issue_id":"council-7yo","author":"Cameron Sjo","text":"Grade: M:B T:C - Similar pattern to ModelSelector. Well-extracted hooks. getBulkAction has conditional logic.","created_at":"2026-02-06T02:00:05Z"}]}
{"id":"council-8az","title":"fetch_available_models","description":"models.py:21-76 — Fetches models from OpenRouter API. In-memory cache with 1hr TTL. Uses deprecated datetime.utcnow(). Returns stale on error (good resilience).","status":"closed","priority":3,"issue_type":"task","owner":"cameronsjo@users.noreply.github.com","created_at":"2026-02-05T19:51:39.445427-06:00","created_by":"Cameron Sjo","updated_at":"2026-02-05T20:34:23.81545-06:00","closed_at":"2026-02-05T20:34:23.81545-06:00","close_reason":"Code fixes applied, tests written, untestable code documented","labels":["audit","just-do-it"],"comments":[{"id":27,"issue_id":"council-8az","author":"Cameron Sjo","text":"GRADE: M=B, T=B | Good in-memory caching with 1hr TTL. Stale cache on error (good). datetime.utcnow() deprecated. RECOMMENDATION: Use datetime.now(timezone.utc).","created_at":"2026-02-06T01:53:01Z"}]}
{"id":"council-8dz","title":"send_message (non-streaming)","description":"main.py:510-559 — Non-streaming message endpoint. Ignores per-conversation config. Uses legacy storage format. Likely dead code.","status":"closed","priority":2,"issue_type":"task","owner":"cameronsjo@users.noreply.github.com","created_at":"2026-02-05T19:51:15.582782-06:00","created_by":"Cameron Sjo","updated_at":"2026-02-06T12:24:26.534017-06:00","closed_at":"2026-02-06T12:24:26.534017-06:00","close_reason":"Removed dead non-streaming code path. PR #12.","labels":["audit","plan-worthy"],"comments":[{"id":19,"issue_id":"council-8dz","author":"Cameron Sjo","text":"GRADE: M=D, T=D | Ignores per-conversation config. Uses legacy add_assistant_message storage. Likely dead code (frontend only uses streaming). RECOMMENDATION: Remove or fix to use per-conversation config.","created_at":"2026-02-06T01:52:44Z"}]}
{"id":"council-8go","title":"query_models_parallel","description":"openrouter.py:108-160 — Queries multiple models in parallel via asyncio.gather. All-or-nothing completion. Double import of asyncio.","status":"closed","priority":2,"issue_type":"task","owner":"cameronsjo@users.noreply.github.com","created_at":"2026-02-05T19:51:07.972668-06:00","created_by":"Cameron Sjo","updated_at":"2026-02-05T20:34:19.67623-06:00","closed_at":"2026-02-05T20:34:19.67623-06:00","close_reason":"Code fixes applied, tests written, untestable code documented","labels":["audit","just-do-it"],"comments":[{"id":18,"issue_id":"council-8go","author":"Cameron Sjo","text":"GRADE: M=B, T=C | asyncio.gather blocks all. Double import of asyncio (module level and inside function). RECOMMENDATION: Remove inline import, consider timeout parameter.","created_at":"2026-02-06T01:52:40Z"}]}
{"id":"council-8mf","title":"Add auth-aware error handling to SSE streams","description":"SSE streaming endpoints (sendMessageStream, extendDebateStream) use raw fetch() for the POST, then read the stream. If auth proxy intercepts the POST, the response is HTML not SSE. readSSEStream will fail parsing. Fix: check response content-type before creating reader, detect auth redirects on stream endpoints, surface typed error to useConversationStream hook.","status":"open","priority":1,"issue_type":"bug","owner":"cameronsjo@users.noreply.github.com","created_at":"2026-02-06T14:22:48.482781-06:00","created_by":"Cameron Sjo","updated_at":"2026-02-06T14:22:48.482781-06:00","labels":["just-do-it"],"dependencies":[{"issue_id":"council-8mf","depends_on_id":"council-c2e","type":"blocks","created_at":"2026-02-06T14:23:04.408893-06:00","created_by":"Cameron Sjo"}]}
{"id":"council-8wv","title":"Audit: CouncilDisplay component + getShortModelName + getProvider helpers","status":"closed","priority":3,"issue_type":"task","owner":"cameronsjo@users.noreply.github.com","created_at":"2026-02-05T20:00:29.429026-06:00","created_by":"Cameron Sjo","updated_at":"2026-02-05T20:34:21.758546-06:00","closed_at":"2026-02-05T20:34:21.758546-06:00","close_reason":"Code fixes applied, tests written, untestable code documented","labels":["just-do-it"],"comments":[{"id":50,"issue_id":"council-8wv","author":"Cameron Sjo","text":"Grade: M:B T:B - Clean panel component with expand/collapse animation. Helper functions are pure and simple. aria-expanded attribute shows accessibility consideration.","created_at":"2026-02-06T02:00:31Z"}]}
{"id":"council-9hu","title":"Audit: Sidebar component (conversation list, config modal, theme toggle)","status":"closed","priority":2,"issue_type":"task","owner":"cameronsjo@users.noreply.github.com","created_at":"2026-02-05T20:00:08.492078-06:00","created_by":"Cameron Sjo","updated_at":"2026-02-06T12:41:18.668768-06:00","closed_at":"2026-02-06T12:41:18.668768-06:00","close_reason":"Extracted 3 pure functions to lib/sidebarUtils.js with 13 tests. PR #17.","labels":["plan-worthy"],"comments":[{"id":38,"issue_id":"council-9hu","author":"Cameron Sjo","text":"Grade: M:C T:D - Multiple responsibilities: conversation management, config modal trigger, theme toggling. Complex state with rename/delete/export flows delegated to ConversationItem.","created_at":"2026-02-06T02:00:11Z"}]}
{"id":"council-9tv","title":"Audit: Round.jsx utilities (formatCost, getReasoningText, getTabLabel, getModelName, getRoundCost)","status":"closed","priority":3,"issue_type":"task","owner":"cameronsjo@users.noreply.github.com","created_at":"2026-02-05T20:00:17.069348-06:00","created_by":"Cameron Sjo","updated_at":"2026-02-05T20:34:23.559146-06:00","closed_at":"2026-02-05T20:34:23.559146-06:00","close_reason":"Code fixes applied, tests written, untestable code documented","labels":["just-do-it"],"comments":[{"id":42,"issue_id":"council-9tv","author":"Cameron Sjo","text":"Grade: M:B T:A - Pure utility functions, simple and testable. getReasoningText handles multiple formats cleanly.","created_at":"2026-02-06T02:00:19Z"}]}
{"id":"council-a0z","title":"stage2_collect_rankings","description":"council.py:219-326 — Each model ranks anonymized Stage 1 responses. Creates anonymous labels (A,B,C), builds ranking prompt, queries all models parallel, parses rankings. Labels break at 26 models.","status":"closed","priority":2,"issue_type":"task","owner":"cameronsjo@users.noreply.github.com","created_at":"2026-02-05T19:50:48.077032-06:00","created_by":"Cameron Sjo","updated_at":"2026-02-06T12:33:24.570812-06:00","closed_at":"2026-02-06T12:33:24.570812-06:00","close_reason":"Fixed 26+ model labels with AA/AB pattern, extracted ranking prompt/system message, fixed falsy check, updated regex for multi-letter labels. PR #14.","labels":["audit","plan-worthy"],"comments":[{"id":10,"issue_id":"council-a0z","author":"Cameron Sjo","text":"GRADE: M=B-, T=C | 40-line prompt literal. Labels break at 26 models (chr(65+i)). No system message. Empty results on all-model failure. RECOMMENDATION: Add AA/AB labels for 26+, extract prompt, add system message.","created_at":"2026-02-06T01:52:23Z"}]}
{"id":"council-akk","title":"reload_config","description":"config.py:159-193 — Reloads .env and config. Mutates module-level globals. Manually patches websearch module TAVILY_API_KEY — fragile cross-module mutation.","status":"closed","priority":3,"issue_type":"task","owner":"cameronsjo@users.noreply.github.com","created_at":"2026-02-05T19:51:29.594276-06:00","created_by":"Cameron Sjo","updated_at":"2026-02-05T20:34:25.598551-06:00","closed_at":"2026-02-05T20:34:25.598551-06:00","close_reason":"Code fixes applied, tests written, untestable code documented","labels":["audit","just-do-it"],"comments":[{"id":23,"issue_id":"council-akk","author":"Cameron Sjo","text":"GRADE: M=C, T=C | Cross-module mutation of websearch.TAVILY_API_KEY. Global variable reassignment. RECOMMENDATION: Use a config singleton or dependency injection.","created_at":"2026-02-06T01:52:51Z"}]}
{"id":"council-aw9","title":"Audit: lib/models.js utilities (formatPrice, getDisplayName, groupModelsByProvider, sortProviders, isMajorProvider, formatContextLength)","status":"closed","priority":4,"issue_type":"task","owner":"cameronsjo@users.noreply.github.com","created_at":"2026-02-05T20:00:36.370288-06:00","created_by":"Cameron Sjo","updated_at":"2026-02-05T20:34:27.212418-06:00","closed_at":"2026-02-05T20:34:27.212418-06:00","close_reason":"Code fixes applied, tests written, untestable code documented","labels":["just-do-it"],"comments":[{"id":55,"issue_id":"council-aw9","author":"Cameron Sjo","text":"Grade: M:A T:A - Pure utility functions. Well-typed with JSDoc. MAJOR_PROVIDERS constant is clean. All functions are trivially testable.","created_at":"2026-02-06T02:00:39Z"}]}
{"id":"council-baq","title":"audit: attachments.py extract_text_from_pdf + extract_text_from_file + encode_image_for_vision","status":"closed","priority":3,"issue_type":"task","owner":"cameronsjo@users.noreply.github.com","created_at":"2026-02-05T20:01:03.949771-06:00","created_by":"Cameron Sjo","updated_at":"2026-02-05T20:34:21.562224-06:00","closed_at":"2026-02-05T20:34:21.562224-06:00","close_reason":"Code fixes applied, tests written, untestable code documented","labels":["just-do-it"],"comments":[{"id":61,"issue_id":"council-baq","author":"Cameron Sjo","text":"Grade: M:C T:D - extract_text_from_pdf has nested try/except with two fallback paths and external deps (PyMuPDF). Hard to test without real PDF files. encode_image_for_vision is clean.","created_at":"2026-02-06T02:01:07Z"}]}
{"id":"council-bcg","title":"Audit: convertCouncilToRounds helper (ChatInterface.jsx)","status":"closed","priority":2,"issue_type":"task","owner":"cameronsjo@users.noreply.github.com","created_at":"2026-02-05T19:59:55.471294-06:00","created_by":"Cameron Sjo","updated_at":"2026-02-05T20:34:19.671571-06:00","closed_at":"2026-02-05T20:34:19.671571-06:00","close_reason":"Code fixes applied, tests written, untestable code documented","labels":["just-do-it"],"comments":[{"id":32,"issue_id":"council-bcg","author":"Cameron Sjo","text":"Grade: M:C T:B - Bridges legacy stage1/stage2/stage3 format to unified rounds format. Complex data mapping but pure function. Mixes two format concerns in one function.","created_at":"2026-02-06T01:59:58Z"}]}
{"id":"council-bqa","title":"Purify: extract _extract_conversation_metadata from storage.list_conversations","status":"closed","priority":3,"issue_type":"task","owner":"cameronsjo@users.noreply.github.com","created_at":"2026-02-05T20:35:49.161976-06:00","created_by":"Cameron Sjo","updated_at":"2026-02-06T12:35:42.723416-06:00","closed_at":"2026-02-06T12:35:42.723416-06:00","close_reason":"Extracted _should_migrate_message and _extract_conversation_metadata. 11 tests. PR #15.","labels":["plan-worthy"]}
{"id":"council-bw0","title":"stage1_collect_responses_streaming","description":"council.py:112-216 — Streaming variant of stage1. Near-complete duplication of stage1_collect_responses. Uses query_models_progressive() with callbacks. Closure captures mutable list.","status":"closed","priority":2,"issue_type":"task","owner":"cameronsjo@users.noreply.github.com","created_at":"2026-02-05T19:50:47.02187-06:00","created_by":"Cameron Sjo","updated_at":"2026-02-06T12:28:10.226599-06:00","closed_at":"2026-02-06T12:28:10.226599-06:00","close_reason":"Merged stage1 functions, extracted shared prompt. PR #13.","labels":["audit","plan-worthy"],"comments":[{"id":9,"issue_id":"council-bw0","author":"Cameron Sjo","text":"GRADE: M=C, T=D | 95% duplicate of stage1_collect_responses. Closure captures mutable list. on_model_response callback blocks next completion if slow. RECOMMENDATION: Merge with stage1_collect_responses using streaming parameter.","created_at":"2026-02-06T01:52:20Z"}]}
{"id":"council-c2e","title":"Create shared fetchJSON wrapper with auth redirect detection","description":"27+ API calls in api.js use raw fetch() with no content-type validation. When behind auth proxy (Authelia), redirects return 200 HTML which passes response.ok check, then response.json() fails silently. Fix: create fetchJSON() wrapper that checks response.redirected, validates content-type: application/json, and throws typed AuthRedirectError or ContentTypeError. Replace all raw fetch+json patterns.","status":"closed","priority":0,"issue_type":"bug","owner":"cameronsjo@users.noreply.github.com","created_at":"2026-02-06T14:22:42.491403-06:00","created_by":"Cameron Sjo","updated_at":"2026-02-06T14:45:50.365928-06:00","closed_at":"2026-02-06T14:45:50.365928-06:00","close_reason":"fetchJSON/fetchWithAuth wrappers implemented. All 21 fetch calls protected. 15 tests. PR #19","labels":["plan-worthy"]}
{"id":"council-c31","title":"stage1_collect_responses","description":"council.py:29-109 — Collects individual responses from all council models in parallel. Builds system prompt + user prompt with optional web search context. Calls query_models_parallel(). Filters out None responses.","status":"closed","priority":2,"issue_type":"task","owner":"cameronsjo@users.noreply.github.com","created_at":"2026-02-05T19:50:46.013376-06:00","created_by":"Cameron Sjo","updated_at":"2026-02-06T12:28:10.224499-06:00","closed_at":"2026-02-06T12:28:10.224499-06:00","close_reason":"Merged stage1 functions, extracted shared prompt. PR #13.","labels":["audit","plan-worthy"],"comments":[{"id":8,"issue_id":"council-c31","author":"Cameron Sjo","text":"GRADE: M=B, T=C | System prompt hardcoded. Same prompt duplicated in streaming variant. No validation of empty council. Silently drops failed models without logging which ones failed. RECOMMENDATION: Extract prompt to prompts.py, add logging for failures.","created_at":"2026-02-06T01:52:18Z"}]}
{"id":"council-coz","title":"aggregate_metrics","description":"council.py:462-559 — Pure function aggregating cost, token, latency metrics across all 3 stages. Takes max latency for parallel stages, adds sequential. Good null handling.","status":"closed","priority":3,"issue_type":"task","owner":"cameronsjo@users.noreply.github.com","created_at":"2026-02-05T19:50:50.992379-06:00","created_by":"Cameron Sjo","updated_at":"2026-02-05T20:34:25.762393-06:00","closed_at":"2026-02-05T20:34:25.762393-06:00","close_reason":"Code fixes applied, tests written, untestable code documented","labels":["audit","just-do-it"],"comments":[{"id":12,"issue_id":"council-coz","author":"Cameron Sjo","text":"GRADE: M=B+, T=A | Pure function. Good null handling with 'or 0.0'. Correctly uses max for parallel, sum for sequential. Clean design.","created_at":"2026-02-06T01:52:27Z"}]}
{"id":"council-cwv","title":"sendMessageStream (frontend)","description":"api.js:315-382 — Frontend SSE client. Fragile SSE parsing (chunks can split mid-JSON). No AbortController. No timeout. 9 parameters.","status":"closed","priority":1,"issue_type":"task","owner":"cameronsjo@users.noreply.github.com","created_at":"2026-02-05T19:51:17.921886-06:00","created_by":"Cameron Sjo","updated_at":"2026-02-06T12:18:42.252091-06:00","closed_at":"2026-02-06T12:18:42.252091-06:00","close_reason":"SSE buffer accumulation implemented in readSSEStream() helper. PR #10.","labels":["audit","plan-worthy"],"comments":[{"id":4,"issue_id":"council-cwv","author":"Cameron Sjo","text":"GRADE: M=C, T=D | SSE parsing splits on newline but chunks can span multiple reads. Silent parse failures lose data. No AbortController. No timeout. 9 parameters. RECOMMENDATION: Add SSE buffer accumulation, AbortController support, options object.","created_at":"2026-02-06T01:52:06Z"}]}
{"id":"council-cza","title":"Telemetry NoOp pattern","description":"telemetry.py — _NoOpTracer/_NoOpSpan avoid conditional checks everywhere. Clean design. get_tracer() creates new _NoOpTracer on every call when disabled.","status":"closed","priority":4,"issue_type":"task","owner":"cameronsjo@users.noreply.github.com","created_at":"2026-02-05T19:51:36.155824-06:00","created_by":"Cameron Sjo","updated_at":"2026-02-05T20:34:27.405254-06:00","closed_at":"2026-02-05T20:34:27.405254-06:00","close_reason":"Code fixes applied, tests written, untestable code documented","labels":["audit","just-do-it"],"comments":[{"id":25,"issue_id":"council-cza","author":"Cameron Sjo","text":"GRADE: M=A, T=A | Clean no-op pattern. Avoids conditional checks everywhere. Minor: creates new _NoOpTracer per call when disabled.","created_at":"2026-02-06T01:52:58Z"}]}
{"id":"council-d1r","title":"Purify: extract _should_migrate_message predicate from storage.migrate_legacy_messages","status":"closed","priority":3,"issue_type":"task","owner":"cameronsjo@users.noreply.github.com","created_at":"2026-02-05T20:35:50.003325-06:00","created_by":"Cameron Sjo","updated_at":"2026-02-06T12:35:42.722364-06:00","closed_at":"2026-02-06T12:35:42.722364-06:00","close_reason":"Extracted _should_migrate_message and _extract_conversation_metadata. 11 tests. PR #15.","labels":["plan-worthy"]}
{"id":"council-d9i","title":"council_event_generator","description":"main.py:582-803 — 200+ line nested async generator for council SSE streaming. Untestable. Handles resume, attachments, web search, all 3 stages, title gen, storage, pending state.","status":"closed","priority":0,"issue_type":"task","owner":"cameronsjo@users.noreply.github.com","created_at":"2026-02-05T19:51:13.822407-06:00","created_by":"Cameron Sjo","updated_at":"2026-02-06T09:05:28.410572-06:00","closed_at":"2026-02-06T09:05:28.410572-06:00","close_reason":"Extracted council_event_generator into backend/council_stream.py with 5 tests","labels":["audit","plan-worthy"],"comments":[{"id":2,"issue_id":"council-d9i","author":"Cameron Sjo","text":"GRADE: M=D, T=F | 200+ line nested async generator. Cannot be unit tested independently. Single try/except wraps entire flow. Queue-based bridge pattern is complex. Interleaves storage, API calls, SSE generation. RECOMMENDATION: Extract to standalone module. Break into per-stage functions that yield events.","created_at":"2026-02-06T01:52:02Z"}]}
{"id":"council-dcv","title":"query_model_streaming","description":"openrouter.py:163-283 — Streams tokens from a single model. Creates new httpx.AsyncClient per request. Loses metadata (actual_model, request_id, provider all None).","status":"closed","priority":1,"issue_type":"task","owner":"cameronsjo@users.noreply.github.com","created_at":"2026-02-05T19:51:09.651706-06:00","created_by":"Cameron Sjo","updated_at":"2026-02-06T11:48:12.672165-06:00","closed_at":"2026-02-06T11:48:12.672165-06:00","close_reason":"PR #8: streaming metadata extraction bundled with council-o7u","labels":["audit","plan-worthy"],"comments":[{"id":5,"issue_id":"council-dcv","author":"Cameron Sjo","text":"GRADE: M=C, T=D | Creates new httpx.AsyncClient per request (no connection pooling). reasoning_details, actual_model, request_id, provider all None in streaming. Significant data loss vs non-streaming. RECOMMENDATION: Share client, extract metadata from SSE chunks.","created_at":"2026-02-06T01:52:08Z"}]}
{"id":"council-due","title":"audit: version.py _get_git_commit + _get_build_time + get_version_info","status":"closed","priority":4,"issue_type":"task","owner":"cameronsjo@users.noreply.github.com","created_at":"2026-02-05T20:01:29.320243-06:00","created_by":"Cameron Sjo","updated_at":"2026-02-05T20:34:25.79412-06:00","closed_at":"2026-02-05T20:34:25.79412-06:00","close_reason":"Code fixes applied, tests written, untestable code documented","labels":["just-do-it"],"comments":[{"id":65,"issue_id":"council-due","author":"Cameron Sjo","text":"Grade: M:B T:C - _get_git_commit shells out to subprocess (hard to test). get_version_info uses lru_cache (good). _get_build_time is trivial env var read.","created_at":"2026-02-06T02:01:32Z"}]}
{"id":"council-dux","title":"Audit: useExpandableGroups + useAutoExpandableGroups hooks","status":"closed","priority":4,"issue_type":"task","owner":"cameronsjo@users.noreply.github.com","created_at":"2026-02-05T20:00:24.81369-06:00","created_by":"Cameron Sjo","updated_at":"2026-02-05T20:34:27.280222-06:00","closed_at":"2026-02-05T20:34:27.280222-06:00","close_reason":"Code fixes applied, tests written, untestable code documented","labels":["just-do-it"],"comments":[{"id":47,"issue_id":"council-dux","author":"Cameron Sjo","text":"Grade: M:A T:A - Clean Set-based state management. useAutoExpandableGroups extends base hook well. Effect dependencies look correct.","created_at":"2026-02-06T02:00:27Z"}]}
{"id":"council-e5b","title":"Audit: ModelSelector component (modal, toggleCouncilMember, handleSave)","status":"closed","priority":3,"issue_type":"task","owner":"cameronsjo@users.noreply.github.com","created_at":"2026-02-05T19:59:57.884977-06:00","created_by":"Cameron Sjo","updated_at":"2026-02-05T20:34:23.755021-06:00","closed_at":"2026-02-05T20:34:23.755021-06:00","close_reason":"Code fixes applied, tests written, untestable code documented","labels":["just-do-it"],"comments":[{"id":33,"issue_id":"council-e5b","author":"Cameron Sjo","text":"Grade: M:B T:C - Clean modal component using extracted hooks. handleSave is async with error handling. Testable with mocked hooks.","created_at":"2026-02-06T02:00:00Z"}]}
{"id":"council-em3","title":"Deliberation data models","description":"deliberation/deliberation.py — Metrics, ParticipantResponse, Round, Synthesis, DeliberationResult dataclasses. Clean design. Could use Pydantic for validation.","status":"closed","priority":3,"issue_type":"task","owner":"cameronsjo@users.noreply.github.com","created_at":"2026-02-05T19:51:31.439309-06:00","created_by":"Cameron Sjo","updated_at":"2026-02-05T20:34:25.54894-06:00","closed_at":"2026-02-05T20:34:25.54894-06:00","close_reason":"Code fixes applied, tests written, untestable code documented","labels":["audit","just-do-it"],"comments":[{"id":24,"issue_id":"council-em3","author":"Cameron Sjo","text":"GRADE: M=A-, T=A | Clean dataclass design. from_dict/to_dict manual but correct. RoundType is str Enum (good for JSON). Could use Pydantic for validation.","created_at":"2026-02-06T01:52:53Z"}]}
{"id":"council-fwv","title":"calculate_aggregate_rankings","description":"council.py:562-606 — Calculates average rank position across all evaluations. Double-parses rankings that were already parsed in Stage 2. Inline defaultdict import.","status":"closed","priority":2,"issue_type":"task","owner":"cameronsjo@users.noreply.github.com","created_at":"2026-02-05T19:50:55.347605-06:00","created_by":"Cameron Sjo","updated_at":"2026-02-05T20:34:19.67741-06:00","closed_at":"2026-02-05T20:34:19.67741-06:00","close_reason":"Code fixes applied, tests written, untestable code documented","labels":["audit","just-do-it"],"comments":[{"id":13,"issue_id":"council-fwv","author":"Cameron Sjo","text":"GRADE: M=C, T=B | Double-parses rankings (already parsed in Stage 2 as parsed_ranking). Inline defaultdict import. No handling for models with zero rankings. RECOMMENDATION: Use pre-parsed rankings from stage2_results.","created_at":"2026-02-06T01:52:32Z"}]}
{"id":"council-gcz","title":"audit: auth.py _get_client_ip","status":"closed","priority":3,"issue_type":"task","owner":"cameronsjo@users.noreply.github.com","created_at":"2026-02-05T20:00:35.923657-06:00","created_by":"Cameron Sjo","updated_at":"2026-02-05T20:34:21.696443-06:00","closed_at":"2026-02-05T20:34:21.696443-06:00","close_reason":"Code fixes applied, tests written, untestable code documented","labels":["just-do-it"],"comments":[{"id":54,"issue_id":"council-gcz","author":"Cameron Sjo","text":"Grade: M:B T:A - Simple X-Forwarded-For parsing. Returns leftmost IP. Testable.","created_at":"2026-02-06T02:00:38Z"}]}
{"id":"council-huc","title":"audit: attachments.py process_attachments orchestrator","status":"closed","priority":3,"issue_type":"task","owner":"cameronsjo@users.noreply.github.com","created_at":"2026-02-05T20:01:09.589638-06:00","created_by":"Cameron Sjo","updated_at":"2026-02-05T20:34:21.532514-06:00","closed_at":"2026-02-05T20:34:21.532514-06:00","close_reason":"Code fixes applied, tests written, untestable code documented","labels":["just-do-it"],"comments":[{"id":62,"issue_id":"council-huc","author":"Cameron Sjo","text":"Grade: M:B T:C - Loops over attachments, delegates to extract/encode functions. Filesystem I/O makes testing harder. Clean separation of text vs image paths.","created_at":"2026-02-06T02:01:12Z"}]}
{"id":"council-ie2","title":"Audit: useCuratedModels hook (toggle, addAll, removeAll, setAll, save, isCurated)","status":"closed","priority":3,"issue_type":"task","owner":"cameronsjo@users.noreply.github.com","created_at":"2026-02-05T20:00:13.872163-06:00","created_by":"Cameron Sjo","updated_at":"2026-02-05T20:34:23.598388-06:00","closed_at":"2026-02-05T20:34:23.598388-06:00","close_reason":"Code fixes applied, tests written, untestable code documented","labels":["just-do-it"],"comments":[{"id":40,"issue_id":"council-ie2","author":"Cameron Sjo","text":"Grade: M:A T:B - Well-structured with optimistic updates. Clean Set-based state management. Good API.","created_at":"2026-02-06T02:00:16Z"}]}
{"id":"council-iux","title":"Audit: Round component (tab rendering, format handling, expand/collapse)","status":"closed","priority":2,"issue_type":"task","owner":"cameronsjo@users.noreply.github.com","created_at":"2026-02-05T20:00:11.040693-06:00","created_by":"Cameron Sjo","updated_at":"2026-02-06T12:39:20.091838-06:00","closed_at":"2026-02-06T12:39:20.091838-06:00","close_reason":"Extracted 5 pure functions to lib/roundUtils.js with 23 tests. PR #16.","labels":["plan-worthy"],"comments":[{"id":39,"issue_id":"council-iux","author":"Cameron Sjo","text":"Grade: M:C T:D - Complex component handling both unified and legacy formats with tab state. Inline de-anonymization logic. Difficult to test due to ReactMarkdown dependency and state.","created_at":"2026-02-06T02:00:13Z"}]}
{"id":"council-lck","title":"Audit: useModels hook (loadModels, refreshModels)","status":"closed","priority":3,"issue_type":"task","owner":"cameronsjo@users.noreply.github.com","created_at":"2026-02-05T20:00:08.391508-06:00","created_by":"Cameron Sjo","updated_at":"2026-02-05T20:34:23.632734-06:00","closed_at":"2026-02-05T20:34:23.632734-06:00","close_reason":"Code fixes applied, tests written, untestable code documented","labels":["just-do-it"],"comments":[{"id":37,"issue_id":"council-lck","author":"Cameron Sjo","text":"Grade: M:A T:B - Clean hook with proper loading/error states. Uses useCallback. Testable with mocked API.","created_at":"2026-02-06T02:00:11Z"}]}
{"id":"council-lrx","title":"pending message functions","description":"storage.py:430-606 — mark_response_pending, update_pending_progress, clear_pending, get_pending_message, is_pending_stale, remove_last_user_message. Single JSON file per user. Hardcoded 10min timeout.","status":"closed","priority":3,"issue_type":"task","owner":"cameronsjo@users.noreply.github.com","created_at":"2026-02-05T19:51:41.852597-06:00","created_by":"Cameron Sjo","updated_at":"2026-02-05T20:34:23.785544-06:00","closed_at":"2026-02-05T20:34:23.785544-06:00","close_reason":"Code fixes applied, tests written, untestable code documented","labels":["audit","just-do-it"],"comments":[{"id":28,"issue_id":"council-lrx","author":"Cameron Sjo","text":"GRADE: M=C, T=B | All pending state in one JSON file. Reads entire file per operation. Hardcoded 10min timeout. RECOMMENDATION: Consider per-conversation pending files.","created_at":"2026-02-06T01:53:03Z"}]}
{"id":"council-m9k","title":"Audit: convertSynthesis helper (ChatInterface.jsx)","status":"closed","priority":3,"issue_type":"task","owner":"cameronsjo@users.noreply.github.com","created_at":"2026-02-05T20:00:00.826903-06:00","created_by":"Cameron Sjo","updated_at":"2026-02-05T20:34:23.725995-06:00","closed_at":"2026-02-05T20:34:23.725995-06:00","close_reason":"Code fixes applied, tests written, untestable code documented","labels":["just-do-it"],"comments":[{"id":34,"issue_id":"council-m9k","author":"Cameron Sjo","text":"Grade: M:B T:B - Clean extraction helper, small and focused. Pure function.","created_at":"2026-02-06T02:00:03Z"}]}
{"id":"council-mig","title":"Fix arena resume: backend ignores resume=true flag entirely","description":"Arena mode in main.py:572-711 has zero resume logic. Backend ignores resume flag, always reruns from scratch. Frontend shows Resume button but it triggers a full re-run. Need: persist completed rounds to pending partial_data, on resume skip completed rounds and continue from last incomplete round.","status":"open","priority":2,"issue_type":"bug","owner":"cameronsjo@users.noreply.github.com","created_at":"2026-02-06T14:29:27.82857-06:00","created_by":"Cameron Sjo","updated_at":"2026-02-06T14:29:27.82857-06:00","labels":["plan-worthy"]}
{"id":"council-mrj","title":"Audit: ConversationItem component (rename, delete, export state machine)","status":"closed","priority":3,"issue_type":"task","owner":"cameronsjo@users.noreply.github.com","created_at":"2026-02-05T20:00:24.080193-06:00","created_by":"Cameron Sjo","updated_at":"2026-02-05T20:34:21.814751-06:00","closed_at":"2026-02-05T20:34:21.814751-06:00","close_reason":"Code fixes applied, tests written, untestable code documented","labels":["just-do-it"],"comments":[{"id":46,"issue_id":"council-mrj","author":"Cameron Sjo","text":"Grade: M:B T:C - Mini state machine with editing/deleting/default modes. Clean event handlers. Inline state transitions could be extracted for testability.","created_at":"2026-02-06T02:00:26Z"}]}
{"id":"council-nnr","title":"Add global auth expiry detection and re-auth UX","description":"When fetchJSON detects an auth redirect, surface it to the user with a global 'Session expired' banner and a re-authenticate link/button. Catch AuthRedirectError at App level, show persistent banner, disable interactions until re-authed. Include the redirect URL so user can click through to login.","status":"open","priority":0,"issue_type":"feature","owner":"cameronsjo@users.noreply.github.com","created_at":"2026-02-06T14:22:44.300472-06:00","created_by":"Cameron Sjo","updated_at":"2026-02-06T14:22:44.300472-06:00","labels":["plan-worthy"],"dependencies":[{"issue_id":"council-nnr","depends_on_id":"council-c2e","type":"blocks","created_at":"2026-02-06T14:23:04.292372-06:00","created_by":"Cameron Sjo"}]}
{"id":"council-o7u","title":"query_model","description":"openrouter.py:23-105 — Queries single model via OpenRouter API. Creates new httpx.AsyncClient per request (no connection pooling). No retry logic. Catch-all exception block.","status":"closed","priority":1,"issue_type":"task","owner":"cameronsjo@users.noreply.github.com","created_at":"2026-02-05T19:51:03.895869-06:00","created_by":"Cameron Sjo","updated_at":"2026-02-06T11:48:12.558387-06:00","closed_at":"2026-02-06T11:48:12.558387-06:00","close_reason":"PR #8: shared httpx client, retry with backoff, differentiated errors","labels":["audit","plan-worthy"],"comments":[{"id":6,"issue_id":"council-o7u","author":"Cameron Sjo","text":"GRADE: M=C, T=D | No connection pooling. No retry logic. Catch-all exception. Cost data may be absent. RECOMMENDATION: Shared httpx client, retry with backoff for 429/502/503, differentiated error handling.","created_at":"2026-02-06T01:52:10Z"}]}
{"id":"council-olx","title":"audit: logging_config.py setup_logging + formatters","status":"closed","priority":4,"issue_type":"task","owner":"cameronsjo@users.noreply.github.com","created_at":"2026-02-05T20:01:14.993388-06:00","created_by":"Cameron Sjo","updated_at":"2026-02-05T20:34:25.857357-06:00","closed_at":"2026-02-05T20:34:25.857357-06:00","close_reason":"Code fixes applied, tests written, untestable code documented","labels":["just-do-it"],"comments":[{"id":63,"issue_id":"council-olx","author":"Cameron Sjo","text":"Grade: M:B T:D - ContextAwareFormatter MUTATES record.msg and record.args (side effect). setup_logging modifies global state (root logger). JSON formatter is cleaner.","created_at":"2026-02-06T02:01:20Z"}]}
{"id":"council-oxk","title":"Add SSE stream resume/re-entrancy after connection drop","description":"When SSE stream drops mid-council (network blip, proxy timeout, tab sleep), there's no recovery. Backend already saves partial progress to pending.json. Frontend should: (1) detect stream drop vs clean completion, (2) on drop, check pending status to see what completed, (3) offer Resume from last completed stage instead of full retry. The backend resume=true path exists but frontend only surfaces it after page reload + manual conversation reselect. Make it automatic: stream drops → check pending → show resume banner inline → one click to continue.","status":"open","priority":1,"issue_type":"feature","owner":"cameronsjo@users.noreply.github.com","created_at":"2026-02-06T14:22:58.688788-06:00","created_by":"Cameron Sjo","updated_at":"2026-02-06T14:22:58.688788-06:00","labels":["plan-worthy"]}
{"id":"council-q56","title":"list_conversations (storage)","description":"storage.py:206-237 — Reads EVERY conversation file to get metadata. O(n) on number of conversations. No pagination, no index.","status":"closed","priority":2,"issue_type":"task","owner":"cameronsjo@users.noreply.github.com","created_at":"2026-02-05T19:51:26.628779-06:00","created_by":"Cameron Sjo","updated_at":"2026-02-05T20:34:19.674054-06:00","closed_at":"2026-02-05T20:34:19.674054-06:00","close_reason":"Code fixes applied, tests written, untestable code documented","labels":["audit","just-do-it"],"comments":[{"id":21,"issue_id":"council-q56","author":"Cameron Sjo","text":"GRADE: M=D, T=B | Reads ALL conversation files. O(n) on conversation count. No pagination, no index. RECOMMENDATION: Add metadata index file or SQLite.","created_at":"2026-02-06T01:52:48Z"}]}
{"id":"council-qby","title":"Audit: Model sub-components (ModelSearchBox, FilterChips, ModelItem, ModelGroupHeader, ModelGroups)","status":"closed","priority":4,"issue_type":"task","owner":"cameronsjo@users.noreply.github.com","created_at":"2026-02-05T20:00:41.44201-06:00","created_by":"Cameron Sjo","updated_at":"2026-02-05T20:34:27.183609-06:00","closed_at":"2026-02-05T20:34:27.183609-06:00","close_reason":"Code fixes applied, tests written, untestable code documented","labels":["just-do-it"],"comments":[{"id":57,"issue_id":"council-qby","author":"Cameron Sjo","text":"Grade: M:A T:B - Clean presentational components. ModelItem supports checkbox/star variants cleanly. FilterChips uses controlled inputs. ModelGroups composes well.","created_at":"2026-02-06T02:00:43Z"}]}
{"id":"council-qfb","title":"generate_conversation_title","description":"council.py:609-644 — Generates short title for conversations. Hardcoded to google/gemini-2.5-flash. Clean fallback to New Conversation. Simple and testable.","status":"closed","priority":3,"issue_type":"task","owner":"cameronsjo@users.noreply.github.com","created_at":"2026-02-05T19:50:57.149605-06:00","created_by":"Cameron Sjo","updated_at":"2026-02-05T20:34:25.718726-06:00","closed_at":"2026-02-05T20:34:25.718726-06:00","close_reason":"Code fixes applied, tests written, untestable code documented","labels":["audit","just-do-it"],"comments":[{"id":14,"issue_id":"council-qfb","author":"Cameron Sjo","text":"GRADE: M=B, T=A- | Hardcoded model (gemini-2.5-flash). 30s timeout sensible. Clean fallback. Simple and testable. RECOMMENDATION: Make model configurable.","created_at":"2026-02-06T01:52:34Z"}]}
{"id":"council-r3n","title":"Add loading timeout + auto-recovery when SSE stream ends without completion event","description":"If backend crashes or stream drops without sending 'complete' event, isLoading stays true forever. User must reload page. Fix: (1) add configurable timeout (e.g. 120s) on readSSEStream reader.read(), (2) when timeout fires, check pending status to see what completed, (3) auto-transition to interrupted state with resume/retry options instead of infinite spinner. Also wrap onEvent callbacks in try-catch so callback errors don't corrupt stream state.","status":"open","priority":1,"issue_type":"bug","owner":"cameronsjo@users.noreply.github.com","created_at":"2026-02-06T14:29:19.046828-06:00","created_by":"Cameron Sjo","updated_at":"2026-02-06T14:29:19.046828-06:00","labels":["plan-worthy"]}
{"id":"council-rah","title":"audit: auth.py _is_trusted_ip","status":"closed","priority":2,"issue_type":"task","owner":"cameronsjo@users.noreply.github.com","created_at":"2026-02-05T20:00:30.527728-06:00","created_by":"Cameron Sjo","updated_at":"2026-02-05T20:34:19.665689-06:00","closed_at":"2026-02-05T20:34:19.665689-06:00","close_reason":"Code fixes applied, tests written, untestable code documented","labels":["just-do-it"],"comments":[{"id":51,"issue_id":"council-rah","author":"Cameron Sjo","text":"Grade: M:C T:B - Re-parses TRUSTED_PROXY_IPS on EVERY call (calls _parse_trusted_ips each time). Should cache parsed result. Correct CIDR logic.","created_at":"2026-02-06T02:00:33Z"}]}
{"id":"council-rqr","title":"Add client-side pending state recovery when API unreachable","description":"When Dismiss/Retry buttons on the interrupted banner trigger API calls that also fail (auth redirect, network error), user is trapped. Fix: (1) Dismiss should work client-side by clearing conversation.pendingInterrupted locally even if DELETE /pending fails. (2) Queue the server-side clear for next successful request. (3) Show toast if server clear failed but still dismiss locally.","status":"open","priority":1,"issue_type":"bug","owner":"cameronsjo@users.noreply.github.com","created_at":"2026-02-06T14:22:50.91219-06:00","created_by":"Cameron Sjo","updated_at":"2026-02-06T14:22:50.91219-06:00","labels":["just-do-it"],"dependencies":[{"issue_id":"council-rqr","depends_on_id":"council-c2e","type":"blocks","created_at":"2026-02-06T14:23:04.544713-06:00","created_by":"Cameron Sjo"}]}
{"id":"council-rsq","title":"handleSendMessage (App.jsx)","description":"App.jsx:430-728 — 300 line function with giant switch statement. Mutable state updates. Not immutable React patterns. No AbortController for cancellation.","status":"closed","priority":0,"issue_type":"task","owner":"cameronsjo@users.noreply.github.com","created_at":"2026-02-05T19:51:22.587866-06:00","created_by":"Cameron Sjo","updated_at":"2026-02-06T09:37:24.651273-06:00","closed_at":"2026-02-06T09:37:24.651273-06:00","close_reason":"Refactored handleSendMessage into useReducer + useConversationStream hook with AbortController and Cancel button","labels":["audit","plan-worthy"],"comments":[{"id":1,"issue_id":"council-rsq","author":"Cameron Sjo","text":"GRADE: M=D, T=F | 300-line function with giant switch statement inside callback. Mutates React state non-immutably. No AbortController. Error rollback assumes exactly 2 messages. RECOMMENDATION: Extract event handler to useReducer, add AbortController, split into sub-handlers per event type.","created_at":"2026-02-06T01:51:58Z"}]}
{"id":"council-ru7","title":"audit: auth.py get_current_user + get_optional_user + require_auth","status":"closed","priority":3,"issue_type":"task","owner":"cameronsjo@users.noreply.github.com","created_at":"2026-02-05T20:00:40.848033-06:00","created_by":"Cameron Sjo","updated_at":"2026-02-05T20:34:21.664727-06:00","closed_at":"2026-02-05T20:34:21.664727-06:00","close_reason":"Code fixes applied, tests written, untestable code documented","labels":["just-do-it"],"comments":[{"id":56,"issue_id":"council-ru7","author":"Cameron Sjo","text":"Grade: M:B T:B - Clean FastAPI dependency pattern. get_optional_user is trivial wrapper. require_auth raises proper HTTPException. Well-structured.","created_at":"2026-02-06T02:00:43Z"}]}
{"id":"council-swr","title":"Deep dive on Arena Mode - full execution path audit","description":"Comprehensive deep dive on Arena Mode, similar to the council-deep-dive.md we did for regular council mode. Trace the full execution path: frontend ArenaMode toggle → backend arena.py → debate rounds (opening/rebuttal/closing) → synthesis → SSE streaming → frontend display. Grade every function, identify bugs, document architecture. Output: detailed document with grades and findings.","status":"closed","priority":2,"issue_type":"task","owner":"cameronsjo@users.noreply.github.com","created_at":"2026-02-06T08:57:50.914439-06:00","created_by":"Cameron Sjo","updated_at":"2026-02-06T12:43:51.284654-06:00","closed_at":"2026-02-06T12:43:51.284654-06:00","close_reason":"Arena Mode audit complete (B+ overall). Anonymization correct during debate rounds, chairman sees identities at synthesis (intentional design, same as council mode). No critical bugs. Minor issues: unused pipeline import in main.py (dead code from refactor), event payload inconsistency. Extend-debate flow works correctly."}
{"id":"council-t62","title":"get_council_models / get_chairman_model","description":"config.py:84-103 — Reads JSON file from disk on every call. No in-memory cache. Called multiple times per request.","status":"closed","priority":2,"issue_type":"task","owner":"cameronsjo@users.noreply.github.com","created_at":"2026-02-05T19:51:27.653423-06:00","created_by":"Cameron Sjo","updated_at":"2026-02-05T20:34:19.672838-06:00","closed_at":"2026-02-05T20:34:19.672838-06:00","close_reason":"Code fixes applied, tests written, untestable code documented","labels":["audit","just-do-it"],"comments":[{"id":22,"issue_id":"council-t62","author":"Cameron Sjo","text":"GRADE: M=C, T=A | File I/O every call. No in-memory cache. Called 6+ times per council run. RECOMMENDATION: Cache with TTL or load once per request.","created_at":"2026-02-06T01:52:50Z"}]}
{"id":"council-tr9","title":"Add per-conversation export button with facet selector","description":"User wants export button that can export different facets of a conversation: (1) full conversation JSON, (2) Stage 1 responses only, (3) Stage 2 rankings only, (4) Stage 3 synthesis only, (5) markdown summary, (6) arena rounds. Critical for when partial results exist (Stage 3 fails but 1+2 succeeded) — user should still be able to export what they paid for.","status":"open","priority":2,"issue_type":"feature","owner":"cameronsjo@users.noreply.github.com","created_at":"2026-02-06T14:29:22.21731-06:00","created_by":"Cameron Sjo","updated_at":"2026-02-06T14:29:22.21731-06:00","labels":["plan-worthy"]}
{"id":"council-tyj","title":"parse_ranking_from_text","description":"council.py:428-459 — Parses FINAL RANKING section from model response. Fragile regex, inline re import, no dedup, no validation of entry count.","status":"closed","priority":2,"issue_type":"task","owner":"cameronsjo@users.noreply.github.com","created_at":"2026-02-05T19:50:50.080943-06:00","created_by":"Cameron Sjo","updated_at":"2026-02-05T20:34:19.678528-06:00","closed_at":"2026-02-05T20:34:19.678528-06:00","close_reason":"Code fixes applied, tests written, untestable code documented","labels":["audit","just-do-it"],"comments":[{"id":11,"issue_id":"council-tyj","author":"Cameron Sjo","text":"GRADE: M=C, T=B | Fragile regex matches single [A-Z] only. Inline 'import re'. No deduplication. Fallback picks up spurious mentions in analysis text before the ranking. RECOMMENDATION: Module-level import, add dedup, restrict fallback to post-FINAL RANKING section.","created_at":"2026-02-06T01:52:26Z"}]}
{"id":"council-u91","title":"Purify: extract _build_partial_message_from_pending from App.jsx loadConversation","status":"closed","priority":3,"issue_type":"task","owner":"cameronsjo@users.noreply.github.com","created_at":"2026-02-05T20:35:51.625585-06:00","created_by":"Cameron Sjo","updated_at":"2026-02-06T12:34:01.199469-06:00","closed_at":"2026-02-06T12:34:01.199469-06:00","close_reason":"Already resolved by useConversationStream refactor. buildAssistantMessage extracted to conversationReducer.js, _build_partial_message_from_pending no longer exists.","labels":["plan-worthy"]}
{"id":"council-ufd","title":"query_models_progressive","description":"openrouter.py:286-379 — Queries models parallel with progressive results via as_completed. POTENTIAL BUG: as_completed may not preserve task identity for lookup. Could cause KeyError crashes.","status":"closed","priority":0,"issue_type":"task","owner":"cameronsjo@users.noreply.github.com","created_at":"2026-02-05T19:51:11.52101-06:00","created_by":"Cameron Sjo","updated_at":"2026-02-06T08:46:10.370484-06:00","closed_at":"2026-02-06T08:46:10.370484-06:00","close_reason":"Fixed: replaced asyncio.as_completed with asyncio.wait(FIRST_COMPLETED) to preserve task identity. PR #5.","labels":["audit","plan-worthy"],"comments":[{"id":3,"issue_id":"council-ufd","author":"Cameron Sjo","text":"GRADE: M=C, T=D | POTENTIAL BUG: asyncio.as_completed may not preserve task identity for task_to_model lookup. Could cause KeyError. pending_models.remove() is O(n). RECOMMENDATION: Use asyncio.wait(FIRST_COMPLETED) pattern or wrap tasks with metadata.","created_at":"2026-02-06T01:52:04Z"},{"id":30,"issue_id":"council-ufd","author":"Cameron Sjo","text":"BUG CONFIRMED: asyncio.as_completed() returns coroutines, NOT original Task objects. task_to_model[completed_task] will ALWAYS KeyError. Tested on Python 3.14.2. This is the ROOT CAUSE of Council being broken.","created_at":"2026-02-06T01:53:19Z"}]}
{"id":"council-wgt","title":"Add file locking + atomic writes for pending.json","description":"pending.json has no file locking. Concurrent SSE streams (cancel + new message, two browser tabs) can corrupt it. Fix: use tempfile + rename pattern for atomic writes, add fcntl.flock() or equivalent for mutual exclusion. Same issue affects conversation JSON files.","status":"open","priority":2,"issue_type":"bug","owner":"cameronsjo@users.noreply.github.com","created_at":"2026-02-06T14:29:25.112153-06:00","created_by":"Cameron Sjo","updated_at":"2026-02-06T14:29:25.112153-06:00","labels":["just-do-it"]}
{"id":"council-ze0","title":"search_web / websearch","description":"websearch.py — Tavily to DuckDuckGo fallback. asyncio.get_event_loop() deprecated pattern. Overall solid.","status":"closed","priority":3,"issue_type":"task","owner":"cameronsjo@users.noreply.github.com","created_at":"2026-02-05T19:51:37.615348-06:00","created_by":"Cameron Sjo","updated_at":"2026-02-05T20:34:25.501574-06:00","closed_at":"2026-02-05T20:34:25.501574-06:00","close_reason":"Code fixes applied, tests written, untestable code documented","labels":["audit","just-do-it"],"comments":[{"id":26,"issue_id":"council-ze0","author":"Cameron Sjo","text":"GRADE: M=B+, T=B+ | Good Tavily-to-DDG fallback. asyncio.get_event_loop() deprecated. Overall solid.","created_at":"2026-02-06T01:52:59Z"}]}
{"id":"council-ztc","title":"Audit: useTheme hook (resolveTheme, cycleTheme, system media listener)","status":"closed","priority":4,"issue_type":"task","owner":"cameronsjo@users.noreply.github.com","created_at":"2026-02-05T20:00:29.69451-06:00","created_by":"Cameron Sjo","updated_at":"2026-02-05T20:34:27.2463-06:00","closed_at":"2026-02-05T20:34:27.2463-06:00","close_reason":"Code fixes applied, tests written, untestable code documented","labels":["just-do-it"],"comments":[{"id":52,"issue_id":"council-ztc","author":"Cameron Sjo","text":"Grade: M:A T:B - Clean implementation. Properly cleans up media query listener. localStorage persistence. Cycle pattern is clear.","created_at":"2026-02-06T02:00:33Z"}]}
